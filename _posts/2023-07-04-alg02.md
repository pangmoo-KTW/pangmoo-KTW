---
layout: post
title: "곱셈"
author: 김태원
categories: Algorithms
tags: [Algorithms]
header-includes:
	- \usepackage[ruled, vlined, linesnumbered]{algorithm2e}
---

*Jeff Erickson의 [Algorithms](https://jeffe.cs.illinois.edu/teaching/algorithms/book/Algorithms-JeffE.pdf){:target="_blank"}을 읽으며 기록한 내용입니다.*

오래된 알고리즘으로는 곱셈을 단계적으로 절차화한 것이 있다.

물론 큰 수를 곱셈하는 알고리즘으로 가장 유명한 것은 **격자**(lattice) 알고리즘이다.
(((고대 중국의 문헌을 접한)) (브라마굽타의 저술을 접한) 알콰리즈미의 저술을 접한) 피보나치가 대중적으로 퍼뜨린 방법이다. 
수메르 문명에도 기록이 존재하니 아무튼 오래된 방법이다.

우선 입력이 숫자로 이루어진 문자열이라고 하자. 
그리고 물론 다른 진법으로 일반화할 수 있지만 그냥 이들 숫자는 10진수라고 하자.
이에 입력은 아래 두 배열의 쌍(pair)으로 구성된다. 

$$
X[0,\ldots, m-1],\quad Y[0,\ldots, n-1].
$$

이들 배열은 두 수 $x,y$를 아래처럼 나타낸다.

$$
x = \sum^{m-1}_{i=0}X[i]\cdot 10^i,\quad y=\sum^{n-1}_{j=0}Y[j]\cdot 10.
$$

이에 출력은 아래 단일 배열으로 구성된다.

$$
Z[0,\ldots,m+n-1].
$$

이 배열은 아래 곱을 나타낸다.

$$
z=x\cdot y = \sum^{m+n-1}_{k=0}Z[k]\cdot10^k.
$$

이 알고리즘은 **덧셈**과 **한자릿수 곱셈**을 **원시 연산**(primitive operation)으로 사용한다.
여기서 덧셈은 for 루프를 사용해 간단히 나타낼 수 있다.
한자릿수 곱셈을 수행하는 오랜 방법은 직접 써서 하거나 표를 사용하는 것이다.
``구구단을 외우자!''라는 노래의 목표가 한자릿수 곱셈의 학습이다. 
아무튼 오늘날의 계산자, 컴퓨터는 ROM(read-only memory)에 저장하는 방식으로 외운다. 

전체 알고리즘은 아래처럼 요약할 수 있다.

$$
x\cdot y = \sum^{m-1}_{i=0}\sum^{n-1}_{j=0}(X[i]\cdot Y[j]\cdot 10^{i+j}).
$$

격자 알고리즘에는 여러 판본이 있을 수 있다.
덧셈과 한자릿수 곱셈을 수행하는 순서나 이들 원시 연산을 구현하는 방법에 따른 차이다. 
아래는 피보나치의 방식을 따른다. 

\begin{algorithm}[H]
\DotPrintSemicolon
\SetAlgoLined
hold $\leftarrow 0$\;
\For{$k\leftarrow 0$ to $n+m-1$}{
	\For{all $i$ and $j$ such that $i+j=k$}{
		hold$\leftarrow$ hold $+X[i]\cdot Y[j]$\;
	}
	$Z[k]\leftarrow$ hold $\mod 10$\;
	hold $\leftarrow\lfloor hold/10 \rfloor$\;
}
return $Z[0,\ldots,m_n-1]$
\caption{Fibonacci Multiply}
\end{algorithm}
